LVL_MUSHROOMS = 0
lvlmap = '10 14\nTTTT~~~~~TTTTT\nT.L.~.xT~~~~~T\nT.R.~.~+~TTT~T\nT~.~~.~.~T~T~T\nT~~~~.~R~T~T~T\nT...~x~~~T~T~T\nTT.T~.~T~T~T~T\nT~+...~..*~+~T\nT~~~~~~~~~~~~T\nTTTTTTTTTTTTTT'
GRID_HEIGHT = int(lvlmap[:lvlmap.index(' ')])
GRID_WIDTH = int(lvlmap[lvlmap.index(' ')+1: lvlmap.index('\n')])
lvlmapcontent = list(lvlmap[lvlmap.index('\n')+1:])
moves = moves = {
    'W': -(GRID_WIDTH + 1),
    'S': GRID_WIDTH + 1,
    'A': -1,
    'D': 1,
    'P': 0
}
_n_indices = range(lvlmapcontent.index('\n'), len(lvlmapcontent), GRID_WIDTH + 1)
mode = 'play'



grid = list(''.join(lvlmapcontent))
player_index = grid.index('L')
MOTHERGRID = list(''.join(lvlmapcontent))
main = 0
player_mushroom_count = 0
item = []
history = {'player': ['.']}
found_item = None


def flame_spread(start_row, start_col):
    # Returns the new map when flamethrower is used, or when player approaches tree while holding flamethrower
    global grid

    grid_string = ''.join(grid)
    grid_2d_list = [list(row) for row in grid_string.strip().split('\n')]
    row, col = len(grid_2d_list), len(grid_2d_list[0])

    def in_bounds(r, c):
        # Returns True if 2d index is within the range of row and column
        return 0 <= r < row and 0 <= c < col

    def flamethrowed(r, c):
        # Replaces 'T' to '.' if another 'T' shares the same side with the initial approached 'T' and is within the bounds else the recursion stops
        if not in_bounds(r, c) or grid_2d_list[r][c] != 'T':
            return
        grid_2d_list[r][c] = '.'

        # Continously calls itself for every direction
        for change_row, change_col in [(-1,0), (1,0), (0,-1), (0,1)]:
            flamethrowed(r + change_row, c + change_col)

    # Will only call flamethrowed if the player is approaching 'T'
    if grid_2d_list[start_row][start_col] == 'T':
        flamethrowed(start_row, start_col)

    new_grid_string = '\n'.join(''.join(row) for row in grid_2d_list)

    return list(new_grid_string)

def pickup(tile):
    # Adds current tile to the list of items held by the player
    item.append(tile)
    # Returns the current tile in emoji form
    return char_to_emoji(tile)

def char_to_emoji(map):
    # Returns the map converted from text characters to emoji
    emoji = {
        '.': 'ã€€',
        'L': 'ðŸ§‘',
        'T': 'ðŸŒ²',
        '+': 'ðŸ„',
        'R': 'ðŸª¨',
        '~': 'ðŸŸ¦',
        '_': 'â¬œ',
        'x': 'ðŸª“',
        '*': 'ðŸ”¥',
        '\n': '\n'
        }
    return ''.join(emoji.get(c, c) for c in map if c in emoji)

def _move_player(direction):

    # Takes the directional input of the player and moves the player accordingly

    global player_index, grid, MOTHERGRID, main, player_mushroom_count, item, history, found_item, DROWNED, mode

    def moveto(under_tile):

        # Mutates the grid; Doesn't return anything
        global player_index, grid, MOTHERGRID, main, player_mushroom_count, item, history

        # Sets the tile left behind by the player as the tile it previously was based on the history list
        grid[player_index] = f"{history['player'][0]}"
        history['player'].pop()

        # Sets the tile at new_index as the player tile
        grid[new_index] = 'L'

        # Updates the current player_index
        player_index = new_index

        # Appends the under_tile(the tile the player moved to) into the history list
        history['player'].append(under_tile)

    # The targeted index of the player based on the move
    new_index = player_index + moves[direction]

    # Checks if either the targeted index is out of bounds
    if not (0 <= new_index < len(grid)) or new_index in _n_indices: # Avoids the mutation of \n indices:
        if mode == "play":
            print("You can't move outside the grid!")
        return

    else:
        # Gets the tile of the targeted index
        target_tile = grid[new_index]

        # Checks the nature of the targeted tile
        if target_tile == 'T':
            if not item: # Player will not move anywhere if not holding an axe
                if mode == "play":
                    return
                    #print("You bumped into a tree!")
            elif item[0] == 'x': # Tree will turn into empty space if player is holding an axe
                moveto('.')
                item.clear() # Item is cleared every time after used
                found_item = None
            elif item[0] == '*': # flame_spread function is called when player is holding flamethrower
                col = (new_index % (GRID_WIDTH+1))
                row = (new_index - col) // GRID_WIDTH
                grid = flame_spread(row, col)
                moveto('.')
                item.clear() # Item is cleared every time after used
                found_item = None
            return

        elif target_tile == 'R':

            # New position of the rock as it moves along with the player
            new_rock_index = new_index + moves[direction]

            if mode == "play":

                # Checks if it is possible to move the rock to the new index
                rock_under_tile = '.'

                if f"Rock {new_index}" in history:  # Sets the tile under the rock based on history, so that the 'moveto' function appends the correct under_tile when the player moves
                    rock_under_tile = history[f"Rock {new_index}"]

                if new_rock_index >= len(grid) or new_rock_index in _n_indices: # Checks if it will go out of bounds or in a '\n' index
                    #print("You can't move the rock there")
                    return

                elif grid[new_rock_index] == "~":   # Converts a water tile into a paved tile
                    grid[new_rock_index] = "_"
                    moveto(rock_under_tile)

                elif grid[new_rock_index] == ".":    # Moves the rock along an empty tile
                    grid[new_rock_index] = "R"
                    moveto(rock_under_tile)

                elif grid[new_rock_index] == "_":   # Moves the rock along a paved tile
                    grid[new_rock_index] = "R"
                    history[f"Rock {new_rock_index}"] = "_" # Takes note of the tile under the rock
                    moveto(rock_under_tile)

                elif grid[new_rock_index] == "R" or 'x' or '*':   # Checks if the player is trying to move two rocks at the same time or into a non-empty tile
                    #print("You can't push the rock there!")
                    return

                if f"Rock {new_index}" in history:    # Removes the Rock at index new_index from history after it gets moved
                    del history[f"Rock {new_index}"]

                return

            else:
                if grid[new_rock_index] == "~":   # Converts a water tile into a paved tile
                    grid[new_rock_index] = "_"
                    moveto(rock_under_tile)

                elif grid[new_rock_index] == ".":    # Moves the rock along an empty tile
                    grid[new_rock_index] = "R"
                    moveto(rock_under_tile)

                elif grid[new_rock_index] == "_":   # Moves the rock along a paved tile
                    grid[new_rock_index] = "R"
                    history[f"Rock {new_rock_index}"] = "_" # Takes note of the tile under the rock
                    moveto(rock_under_tile)

                elif grid[new_rock_index] == "R" or 'x' or '*':   # Checks if the player is trying to move two rocks at the same time or into a non-empty tile
                    #print("You can't push the rock there!")
                    return

            if f"Rock {new_index}" in history:  # Removes the Rock at index new_index from history after it gets moved
                    del history[f"Rock {new_index}"]

            return

        elif target_tile == '~':

            # Moves the player into the water
            moveto('~')

            # Changes the following player attributes
            DROWNED = True
            main += 1

            return

        elif target_tile == "+":

            # Increases the collected mushroom count of the player
            player_mushroom_count += 1

            # Checks if the player has reached the required amount of mushrooms
            if player_mushroom_count == LVL_MUSHROOMS:
                moveto('+')
                main += 1

            # Moves the player and leaves an empty tile
            moveto('.')
            return

        elif target_tile == "x":

            # Updates the found item as an axe
            found_item = 'x'
            moveto('x')

            return

        elif target_tile == "*":

            # Updates the found item as a flamethrower
            found_item = '*'
            moveto('*')

            return

        elif target_tile == "_":

            # No items in a paved tile
            found_item = None
            moveto('_')

            return

        else:

            # No items in an empty tile
            found_item = None
            moveto('.')

            return

def move_player(direction):

    # Takes the user input and proceeds accordingly
    global player_index, grid, MOTHERGRID, main, player_mushroom_count, item, history, found_item

    # Processes each input in a string of inputs
    for inp in direction:
        inp = inp.upper()
        if main == 0:
            if inp == 'Q':
                main += 1

            elif inp == 'P':
                # Picks up the found item
                if mode == "play":
                    if not found_item:
                        print("Invalid move. Use W, A, S, D.")
                    elif len(item) == 1:
                        print('You already have an item, you can\'t pickup another')
                    else:
                        pickup(found_item)
                        found_item = None
                        history['player'][-1] = '.' # Sets the previous tile as an empty tile after picking up the item
                else:
                    if not found_item:
                        pass
                    elif len(item) == 1:
                        pass
                    else:
                        pickup(found_item)
                        found_item = None
                        history['player'][-1] = '.' # Sets the previous tile as an empty tile after picking up the item

            elif inp == "!":
                # Restarts the game

                # Restores the player attributes back to default
                player_index = MOTHERGRID.index('L')
                grid = list(MOTHERGRID)
                found_item = None
                item = []
                history = {'player': ['.']}
                player_mushroom_count = 0

            elif inp in moves:
                _move_player(inp)

            # Breaks the loop when an invalid input is detected
            else:
                break
        else:
            break




'''
['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 
 'T', '.', 'L', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 
 'T', '.', 'R', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 
 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 
 'T', '~', '~', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 
 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 
 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 
 'T', '~', '+', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 
 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 
 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']

'''


def test_move_player():
    global grid, MOTHERGRID, main

    # Test case 1: moving to empty tile.
    move_player('a')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', 'L', '.', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', 'R', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '~', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '+', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 2: bumping onto a tree.
    move_player('w')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', 'L', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', 'R', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '~', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '+', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 3: moving to empty tile.
    move_player('s')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', 'L', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', 'R', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '~', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '+', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 4: pushing a rock.
    move_player('d')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', 'L', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', 'R', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '~', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '+', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 5: walking towards a water tile. game ends.
    move_player('dd')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', 'L', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', 'R', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '~', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '+', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    assert main == 1
    main = 0
    move_player('!')

    # Test case 6: walking past a water tile. player should not move from the water tile. game ends.
    move_player('ddd')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', 'L', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', 'R', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '~', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '+', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    assert main == 1
    main = 0
    move_player('!')

    # Test case 7: walking past a tree. player should stop before tree.
    move_player('sssssdd')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '_', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', 'L', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '+', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 8: player pushes rock to pavement.
    move_player('ss')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', 'L', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '_', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '+', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 9: player walks on pavement.
    move_player('sss')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', 'L', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '+', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 10: walking beyond the grid. player should not move further than grid.
    move_player('aa')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', 'L', '.', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', 'R', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '~', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '+', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 11: player walks on a mushroom.
    move_player('ssssss')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '_', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', 'L', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 12: player walks past a mushroom.
    move_player('ssssssdd')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '_', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '.', '.', 'L', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 13: player walks to an axe.
    move_player('ssssssdddww')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '_', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'L', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '.', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 14: player walks past an axe without picking up.
    move_player('ssssssdddwww')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '_', '~', '~', 'L', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', 'x', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '.', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 15: player picks up axe then walks away.
    move_player('ssssssdddwwpw')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '_', '~', '~', 'L', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '.', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 16: player uses axe on tree.
    move_player('ssssssdddwwpssaaw')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '_', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'L', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '.', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 17: player uses axe then bumps on tree.
    move_player('ssssssdddwwpssaawaa')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', 'x', 'T', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '+', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '_', '~', '~', '.', '~', 'R', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '~', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', 'L', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '.', '.', '.', '.', '~', '.', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 18: player walks to flamethrower.
    move_player('ssssssdddwwpwwwwddapdssssssdd')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', '.', '.', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '.', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '_', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '_', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '.', '.', '.', '.', '~', '.', '.', 'L', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 19: player walks past flamethrower without picking up.
    move_player('ssssssdddwwpwwwwddapdssssssddaa')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', '.', '.', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '.', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '_', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '_', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '.', '.', '.', '.', '~', 'L', '.', '*', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 20: player picks up flamethrower then walks away.
    move_player('ssssssdddwwpwwwwddapdssssssddpaa')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', '.', '.', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '.', '~', 'T', 'T', 'T', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '_', '~', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '_', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', '.', '~', 'T', '~', 'T', '~', 'T', '\n', 'T', '~', '.', '.', '.', '.', '~', 'L', '.', '.', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 21: player uses flamethrower on tree.
    move_player('ssssssdddwwpwwwwddapdssssssddpw')
    assert grid == ['T', 'T', 'T', 'T', '~', '~', '~', '~', '~', 'T', 'T', 'T', 'T', 'T', '\n', 'T', '.', '.', '.', '~', '.', '.', '.', '~', '~', '~', '~', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '.', '~', '.', '.', '.', '~', 'T', '\n', 'T', '~', '.', '~', '~', '.', '~', '.', '~', '.', '~', '.', '~', 'T', '\n', 'T', '~', '_', '~', '~', '.', '~', '.', '~', '.', '~', '.', '~', 'T', '\n', 'T', '.', '.', '.', '~', '.', '~', '_', '~', '.', '~', '.', '~', 'T', '\n', 'T', 'T', '.', 'T', '~', '.', '~', '.', '~', 'L', '~', '.', '~', 'T', '\n', 'T', '~', '.', '.', '.', '.', '~', '.', '.', '.', '~', '+', '~', 'T', '\n', 'T', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', '~', 'T', '\n', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T']
    move_player('!')

    # Test case 22: player pushes rock while holding axe.

    # Test case 23: player pushes rock while holding flamethrower.

    # Test case 24: player pushes rock to tree.

    # Test case 25: player pushes rock to edge.

    # Test case 26: player pushes rock to pavement.

    # Test case 27: player pushes rock past pavement.

    # Test case 28: player picks up axe while holding flamethrower.

    # Test case 29: player picks up flamethrower while holding axe.

    # Test case 30: player picks up axe while holding axe.

    # Test case 31: player picks up flamethrower while holding flamethrower.


test_move_player()
